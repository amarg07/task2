some new changes are made for bugfix.